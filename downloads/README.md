# GEE Downloader Output Metadata

This document describes the structure of the output generated by the `comprehensive_gee_downloader.py` script.

## Directory Structure

The output from the downloader is organized by the Region of Interest (ROI) that was processed. For each ROI, a dedicated folder is created.

```
downloads/
└── <roi_name>/
    ├── downloaded_zips/
    │   ├── <task_id_1>.zip
    │   ├── <task_id_2>.zip
    │   └── ...
    └── task_mapping.json
```

-   **`<roi_name>`**: A directory named after the ROI identifier used for the download (e.g., `D-49-49-A`).
-   **`downloaded_zips/`**: This sub-directory contains all the final zipped data archives. Each zip file is named with a unique UUID (the "task ID").
-   **`task_mapping.json`**: A crucial JSON file that provides a detailed log and index of the downloaded data. It links each task ID to the specific dataset, date range, and files it contains.

---

## `task_mapping.json` File Structure

The `task_mapping.json` file is the central index for your downloaded data. It is composed of two main sections: `summary` and `task_mapping`.

### 1. `summary` Section

This section provides a high-level overview of the entire download job.

-   **`total_tasks`** (Integer): The total number of datasets successfully downloaded and zipped.
-   **`datasets`** (Object): A dictionary that tallies the number of tasks completed for each dataset type.
-   **`date_range`** (Object): The start and end dates for the entire download query.
    -   **`start`** (String): The start date in `YYYY-MM-DD` format.
    -   **`end`** (String): The end date in `YYYY-MM-DD` format.
-   **`generated_at`** (String): An ISO 8601 timestamp indicating when the mapping file was created.

### 2. `task_mapping` Section

This section provides a detailed entry for each downloaded dataset. It is an object where each key is a unique **Task ID (UUID)** corresponding to a `.zip` file in the `downloaded_zips/` directory.

Each task entry contains the following fields:

-   **`dataset_type`** (String): The type of the dataset contained in the zip file (e.g., `"era5"`, `"sentinel2"`, `"landsat8_l2"`).
-   **`date_range`** (Object): The start and end dates for the data contained within this specific archive.
    -   **`start`** (String): The start date in `YYYY-MM-DD` format.
    -   **`end`** (String): The end date in `YYYY-MM-DD` format.
-   **`zip_path`** (String): The filename of the corresponding zip archive (e.g., `"3e1a7d90-bfe2-455b-bd7b-890d400197cd.zip"`).
-   **`file_count`** (Integer): The total number of `.tif` files contained within the zip archive.

### Example `task_mapping.json`

```json
{
  "summary": {
    "total_tasks": 5,
    "datasets": {
      "aster": 1,
      "era5": 1,
      "landsat8_l2": 1,
      "landsat9_l2": 1,
      "sentinel2": 1
    },
    "date_range": {
      "start": "2023-01-01",
      "end": "2023-01-31"
    },
    "generated_at": "2023-10-27T10:30:00.123456"
  },
  "task_mapping": {
    "3e1a7d90-bfe2-455b-bd7b-890d400197cd": {
      "dataset_type": "sentinel2",
      "date_range": {
        "start": "2023-01-01",
        "end": "2023-01-31"
      },
      "zip_path": "3e1a7d90-bfe2-455b-bd7b-890d400197cd.zip",
      "file_count": 6
    },
    "a1b2c3d4-e5f6-7890-1234-567890abcdef": {
      "dataset_type": "era5",
      "date_range": {
        "start": "2023-01-01",
        "end": "2023-01-31"
      },
      "zip_path": "a1b2c3d4-e5f6-7890-1234-567890abcdef.zip",
      "file_count": 1488
    }
  }
}
```
